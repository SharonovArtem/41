using System;
using System.Text.RegularExpressions;



namespace dzkurs
{
    internal class Program
    {
        static void Main(string[] args)
        {
            Library library = new Library();
            Book book = new Book(null, null, null, 0);
            bool isWorking = true;
            string addBookCommand = "1";
            string deleteBookCommand = "2";
            string showBookByNameCommand = "3";
            string showAllBooksCommand = "4";
            string exitCommand = "5";
            string command;

            while (isWorking)
            {
                Console.WriteLine("Введите команду");
                Console.WriteLine($"Добавить книгу - 1");
                Console.WriteLine($"Удалить книгу - 2");
                Console.WriteLine($"Найти книгу по названию - 3");
                Console.WriteLine($"Показать все книги - 4");

                command = Console.ReadLine();

                if (command == addBookCommand)
                {
                    library.AddNewBook();
                }
                else if (command == deleteBookCommand)
                {
                    library.RemoveBook();
                }
                else if (command == showBookByNameCommand)
                {
                    library.showBookByName();
                }
                else if (command == showAllBooksCommand)
                {
                    library.ShowAllBooks();
                }
                else if (command == exitCommand)
                {
                    isWorking = false;
                }
                else
                {
                    Console.WriteLine("Неизвестная команда");
                }
            }
        }
    }

    class Book
    {
        public string Author { get; private set; }
        public string Name { get; private set; }
        public string ReleaseYear { get; private set; }
        public int Number { get; private set; }

        public Book(string author, string name, string releaseYear, int number)
        {
            Name = name;
            Author = author;
            ReleaseYear = releaseYear;
            Number = number;
        }

        public void ShowInfo(string name, string author, string releaseYear)
        {
            Console.WriteLine("Название книги " + name);
            Console.WriteLine("Автор книги " + author);
            Console.WriteLine("Год выпуска " + releaseYear);
        }
    }

    class Library
    {
        public List<Book> Books { get; private set; } = new List<Book>();

        public List<Book> AddNewBook()
        {
            int numberOfBookInList = 0;
            string userInputName;
            string userInputAuthor;
            string userInputReleaseYear;

            Console.WriteLine("Введите название книги");

            userInputName = Console.ReadLine();

            Console.WriteLine("Введите автора");

            userInputAuthor = Console.ReadLine();

            Console.WriteLine("И год выпуска");

            userInputReleaseYear = Console.ReadLine();

            Book book = new Book(userInputAuthor, userInputName, userInputReleaseYear, numberOfBookInList);

            Books.Add(book);

            Console.WriteLine($"Книга {book.Name} добавлена");

            numberOfBookInList++;

            return Books;
        }

        public void ShowAllBooks()
        {
            for (int i = 0; i < Books.Count; i++)
            {
                Books[i].ShowInfo(Books[i].Name, Books[i].Author, Books[i].ReleaseYear);
            }
        }

        public List<Book> RemoveBook()
        {
            string userInput;

            Console.WriteLine("Введите номер книги");
            userInput = Console.ReadLine();

            for (int i = 0; i < Books.Count; i++)
            {
                if (Convert.ToString(Books[i].Number) == userInput)
                {
                    Console.WriteLine($"Книга {Books[i].Name} удалена!");
                    Books.Remove(Books[i]);
                }
            }

            return Books;
        }

        public void showBookByName()
        {
            string userInput;

            Console.WriteLine("Введите название книги");
            userInput = Console.ReadLine();

            for (int i = 0; i < Books.Count; i++)
            {
                if (Regex.IsMatch(Books[i].Name, userInput))
                {
                    Console.WriteLine($"{Books[i].Name}, {Books[i].Author}, {Books[i].ReleaseYear}");
                }
            }
        }
    }
}
