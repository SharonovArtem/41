using System;
using System.Text.RegularExpressions;



namespace dzkurs
{
    internal class Program
    {
        static void Main(string[] args)
        {
            Library library = new Library();
            bool isWorking = true;
            string addBookCommand = "1";
            string deleteBookCommand = "2";
            string findBookCommand = "3";
            string showAllBooksCommand = "4";
            string exitCommand = "5";
            string command;

            while (isWorking)
            {
                Console.WriteLine("Введите команду");
                Console.WriteLine($"Добавить книгу - " + addBookCommand);
                Console.WriteLine($"Удалить книгу - " + deleteBookCommand);
                Console.WriteLine($"Найти книгу - " + findBookCommand);
                Console.WriteLine($"Показать все книги - " + exitCommand);

                command = Console.ReadLine();

                if (command == addBookCommand)
                {
                    library.AddNewBook();
                }
                else if (command == deleteBookCommand)
                {
                    library.RemoveBook();
                }
                else if (command == findBookCommand)
                {
                    library.FindBook();
                }
                else if (command == showAllBooksCommand)
                {
                    library.ShowAllBooks();
                }
                else if (command == exitCommand)
                {
                    isWorking = false;
                }
                else
                {
                    Console.WriteLine("Неизвестная команда");
                }
            }
        }
    }

    class Book
    {
        public string Author { get; private set; }
        public string Name { get; private set; }
        public string ReleaseYear { get; private set; }
        public int Number { get; private set; }

        public Book(string author, string name, string releaseYear, int number)
        {
            Name = name;
            Author = author;
            ReleaseYear = releaseYear;
            Number = number;
        }

        public void ShowInfo()
        {
            Console.WriteLine("Название книги " + Name);
            Console.WriteLine("Автор книги " + Author);
            Console.WriteLine("Год выпуска " + ReleaseYear);
        }
    }

    class Library
    {
        private List<Book> _books = new List<Book>();

        public void AddNewBook()
        {
            int numberOfBookInList = 0;
            string name;
            string author;
            string releaseYear;

            Console.WriteLine("Введите название книги");

            name = Console.ReadLine();

            Console.WriteLine("Введите автора");

            author = Console.ReadLine();

            Console.WriteLine("И год выпуска");

            releaseYear = Console.ReadLine();

            Book book = new Book(author, name, releaseYear, numberOfBookInList);

            _books.Add(book);

            Console.WriteLine($"Книга {book.Name} добавлена");

            numberOfBookInList++;
        }

        public void ShowAllBooks()
        {
            for (int i = 0; i < _books.Count; i++)
            {
                _books[i].ShowInfo();
            }
        }

        public void RemoveBook()
        {
            int userInput;

            Console.WriteLine("Введите номер книги");
            userInput = Convert.ToInt32(Console.ReadLine());


            for (int i = 0; i < _books.Count; i++)
            {
                if (_books[i].Number == userInput)
                {
                    Console.WriteLine($"Книга {_books[i].Name} удалена!");
                    _books.Remove(_books[i]);
                }
            }
        }

        public void FindBook()
        {
            string userInput;
            string wantedBook = null;

            Console.WriteLine("Введите название книги, автора или дату выпуска");
            userInput = Console.ReadLine();

            for (int i = 0; i < _books.Count; i++)
            {
                if (Regex.IsMatch(_books[i].Name, userInput) || Regex.IsMatch(_books[i].Author, userInput) || Regex.IsMatch(_books[i].ReleaseYear, userInput))
                {
                    Console.WriteLine($"{_books[i].Name}, {_books[i].Author}, {_books[i].ReleaseYear}");

                    wantedBook = _books[i].Name;
                }                
            }

            if (wantedBook == null)
            {
                Console.WriteLine("Мы ничего не нашли:(");
            }
        }
    }
}
